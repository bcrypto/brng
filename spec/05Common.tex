\chapter{Общие положения}\label{COMMON}

\section{Назначение}\label{COMMON.Dest}

Настоящий стандарт определяет криптографические алгоритмы
генерации псевдослучайных чисел.
%
В алгоритмах используются ключ и синхропосылка.
%
При соблюдении секретности ключа и уникальности синхропосылки
генерируемые числа трудно предугадать или повторить,
и поэтому их можно использовать для построения непредсказуемых
и уникальных параметров криптографических алгоритмов и протоколов, 
в том числе других ключей и синхропосылок.

Ключ алгоритма генерации может быть известен одной или нескольким сторонам.
В первом случае псевдослучайные числа можно использовать для построения 
секретных параметров владельца ключа. 
Во втором случае стороны могут использовать алгоритм 
для построения общих секретных параметров.

В~\ref{HMAC} определяется алгоритм выработки имитовставки в режиме HMAC
(Hash-based Message Authentication Code),
соответствующий~\cite{RFC-HMAC}.
%
Этот алгоритм используется как вспомогательный
при генерации псевдослучайных чисел в~\ref{PRNG-HMAC}.
%
Кроме этого, алгоритм имеет самостоятельное 
значение и может применяться непосредственно для 
выработки имитовставок. 
%
Если на вход алгоритма подавать неповторяющиеся 
синхропосылки, например отметки текущего времени,
то выходные имитовставки можно использовать в качестве 
псевдослучайных чисел.

В~\ref{PRNG-CTR} определяется алгоритм генерации псевдослучайных чисел 
в режиме счетчика. В этом алгоритме ключ и синхропосылка являются 
словами фиксированной длины. На шагах алгоритма используются дополнительные 
входные данные, которые можно выбирать случайным или псевдослучайным 
образом. 
Дополнительные входные данные увеличивают неопределенность выходных. 

В~\ref{PRNG-HMAC} определяется алгоритм генерации псевдослучайных чисел 
в режиме HMAC. В этом алгоритме ключ и синхропосылка являются словами 
произвольной длины, дополнительные входные данные не используются.
Алгоритм используется в СТБ 34.101.65.

В приложении~\ref{OTP} определяются алгоритмы генерации 
одноразовых паролей, а также правила проверки этих паролей. 
%
Одноразовые пароли строятся как псевдослучайные числа по 
имитовставкам~HMAC.  
%
Алгоритмы и правила приложения
соответствуют спецификациям~\cite{HOTP}~--- \cite{OCRA}. 
%
Рекомендуется использовать приложение для усиления 
аутентификации в клиент-серверных системах.

В приложении~\ref{ASN} приводится модуль
абстрактно-синтаксической нотации версии~1 (АСН.1),
определенной в~ГОСТ 34.973.
Модуль задает идентификаторы алгоритмов и 
описывает особенности использования в алгоритмах 
функций хэширования.
%
Рекомендуется использовать модуль 
при встраивании алгоритмов стандарта в информационные системы, 
в которых также используется АСН.1.

В приложении~\ref{TEST} приводятся примеры выполнения алгоритмов стандарта.
Примеры можно использовать для проверки корректности 
реализаций алгоритмов.

\section{Функция хэширования}\label{COMMON.Hash}

В алгоритмах настоящего стандарта используется функция хэширования~$h$,
которая ставит в соответствие сообщению~$X\in\{0,1\}^*$ 
его хэш-значение~$h(X)\in\{0,1\}^{2l}$.
%
%Генерируемые псевдослучайные числа являются хэш-значениями
%вычисляемых по определенным правилам сообщений~$X$.

Функция~$h$ должна быть алгоритмически определена в некотором ТНПА. 
Например в качестве~$h$ может использоваться функция, 
заданная в СТБ 1176.1 или СТБ 34.101.31 (пункт~6.9).
Для обеих этих функций $l=128$.

В алгоритмах режимов~HMAC требуется, чтобы~$h$ была 
блочно-итерационной. Это значит, что хэширование состоит в итерационной 
обработке последовательных блоков~$X$,
причем блоки являются двоичными словами одной и той же длины~$b$.
%
Дополнительно требуется, чтобы длина блока~$b$ была кратна~$8$ и не была 
меньше~$2l$.
%
Алгоритм выработки имитовставки в режиме~HMAC на основе допустимой функции 
хэширования~$h$ обозначается через~$\HMAC[h]$.

Функции, заданные в~СТБ 1176.1 и~СТБ 34.101.31, удовлетворяют ограничениям~HMAC. 
Для них $b=256$.

\section{Ключ}\label{COMMON.Key}

Ключ, который используется при генерации псевдослучайных чисел,
должен вырабатываться без возможности предсказания, 
распространяться с соблюдением мер конфиденциальности и храниться в секрете.

Один и тот же ключ не должен использоваться в различных алгоритмах
настоящего стандарта.

Ключом является двоичное слово фиксированной 
(для алгоритма из~\ref{PRNG-CTR})
или произвольной 
(для алгоритмов из~\ref{HMAC}, \ref{PRNG-HMAC}, 
приложения~\ref{OTP}) длины.
%
В режимах~HMAC
рекомендуется применять ключ, длина которого совпадает с длиной значений 
используемой функции хэширования~$h$.

Ключ можно генерировать псевдослучайным методом с помощью одного 
из алгоритмов стандарта. При генерации должен использоваться другой 
ключ, который также может быть построен псевдослучайным методом еще
на одном ключе и т.~д. Для построения первоначальных ключей
должны применяться генераторы случайных чисел.
%
В приложении~\ref{RNG} даются справочные сведения по использованию таких 
генераторов. 

\section{Синхропосылка}

Синхропосылка, которая используется при генерации псевдослучайных чисел,
должна быть уникальной.
%
Уникальность означает, что при многократном применении алгоритма генерации 
с одним и тем же ключом вероятность совпадения используемых
синхропосылок пренебрежимо мала.

Синхропосылка не является секретным параметром, может быть общедоступной.

Синхропосылки можно вырабатывать случайным или псевдослучайным 
методом, строить по отметкам времени, значениям монотонного счетчика, 
неповторяющимся номерам сообщений и др.

